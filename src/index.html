<!doctype html>
<html>
<head>
    <title>YouTube Inbox</title>

    <link rel="stylesheet" href="libraries/font-awesome-4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="index.css">

    <script src="http://code.jquery.com/jquery-2.0.0.js"></script>
    <script src="libraries/gapi/auth.js"></script>
    <script src="https://apis.google.com/js/client.js?onload=googleApiClientReady"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="libraries/linkify/linkify.min.js"></script>
    <script src="libraries/linkify/linkify-string.min.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>

    <link rel="icon" href="favicon-vflz7uhzw.ico" sizes="32x32">
</head>
<body>
<div id="container"></div>

<script id="template" type="text/html">
    <div class="top-bar">
        <label for="settings-toggle" class="btn btn-default settings-toggle"><i class="fa fa-gear"></i></label>
        <button class="btn btn-default" id="refresh"><i class="fa fa-refresh"></i></button>

        {{#each videoLists}}
        <input type="radio" name="tab" id="tab-{{name}}" checked="{{display}}">
        <label for="tab-{{name}}" id="{{name}}" class="tab">
            <div class="text">{{name}} ({{videos.length}})</div>
        </label>
        {{/each}}

        <button id="all-done" class="btn btn-default" title="Mark all as watched"><i class="fa fa-check"></i></button>
        <button id="all-undone" class="btn btn-default" title="Mark all as unwatched"><i class="fa fa-remove"></i>
        </button>
    </div>
    <div class="videos">
        {{#each videoLists}}
        {{#if display}}
        <div class="{{name}}-videos video-list">
            {{#each videos}}
            {{>video}}
            {{/each}}
        </div>
        {{/if}}
        {{/each}}
        <div class="no-videos">
            End of videos.
        </div>
        <input id="settings-toggle" type="checkbox">

        <div class="settings">
            <label for="settings-toggle" class="btn btn-default settings-toggle"><i class="fa fa-gear"></i></label>
            <button class="btn btn-default pre-auth" id="login-link">Log in</button>
            <label>Update interval:<input id="update-interval" type="number" value="{{updateInput}}"/>minutes.
                <div class="note">(0 for never)</div>
            </label>
            <label>Discard watched videos older than<input id="history-length" type="number" value="{{historyInput}}"/>days
                old.</label>

            <p class="note">(Unwatched videos will be kept forever)</p>
            <div class="checkbox">
                <label><input type="checkbox" id="autoplay" checked="{{autoplayInput}}">Auto-play videos?</label>
            </div>
            <div class="checkbox">
                <label><input type="checkbox" id="expand" checked="{{expandInput}}">Expand playing videos?</label>
            </div>

            <h4>Filters:</h4>

            {{#with filter}}
            <div class="filter-panel">
                <div class="header">
                    <div class="author">Channel Name:</div>
                    <div class="type"></div>
                    <div class="regex">Filter:</div>
                </div>
                <div class="rows">
                    {{#each contents:index}}
                    <div class="row">
                        <input class="author" type="text" value="{{channel}}">
                        <select class="type form-control" value="{{type}}">
                            <option value="blacklist">Blacklist</option>
                            <option value="whitelist">Whitelist</option>
                        </select>
                        <input class="regex" type="text" value="{{regexes}}">
                        <button class="btn btn-default" on-click="filterRemove:{{index}}">Remove</button>
                    </div>
                    {{/each}}
                </div>
                <button class="btn btn-default" on-click="filterAdd">Add</button>
            </div>
            {{/with}}
        </div>
    </div>

    {{#partial video}}
    <div class="video-container">
        <input type="checkbox" class="expanded" id="expand-{{id}}">
        <div class="video" on-click="play">
            <div class="thumbnail" style="background-image: url({{thumbnail}})">
                <p>{{title}}</p>
                <i class="fa fa-play fa-3x"></i>
            </div>
        </div>
        <div class="video-info">
            <div class="author">
                <a href="http://www.youtube.com/channel/{{authorId}}" target="_blank">{{author}}</a>
            </div>
            <div class="upload-date">uploaded {{publishedDate}}</div>
            <input type="checkbox" class="truncated" id="trunc-{{id}}" checked="checked">

            <div class="description">
                {{#each paragraphs}}
                <p>{{{this}}}</p>
                {{/each}}
            </div>

            <label for="trunc-{{id}}">
                <span class="read-more">Read more</span>
                <span class="read-less">Read less</span>
            </label>
        </div>
        <div class="side-buttons">
            {{#if name === 'unwatched'}}
            <button class="mark btn btn-default" title="Mark as watched" on-click="done:{{id}}"><i class="fa fa-check fa-3x"></i></button>
            {{elseif name == 'watched'}}
            <button class="mark btn btn-default" title="Mark as unwatched" on-click="undone:{{id}}"><i class="fa fa-remove fa-3x"></i></button>
            {{/if}}
            <a class="youtube-watch btn btn-default" title="Watch on YouTube"
               href="https://www.youtube.com/watch?v={{id}}" target="_blank">
                <i class="fa fa-youtube fa-3x"></i>
            </a>
            <label for="expand-{{id}}">
                <div class="expand-player btn btn-default" title="Expand Video"><i class="fa fa-expand fa-3x"></i></div>
                <div class="compress-player btn btn-default" title="Compress Video"><i class="fa fa-compress fa-3x"></i>
                </div>
            </label>
        </div>
    </div>
    {{/partial}}
</script>

<script src='http://cdn.ractivejs.org/latest/ractive.min.js'></script>
<script src="index.js"></script>
</body>
<head>
    <title>YouTube Inbox</title>

    <link rel="stylesheet" href="libraries/font-awesome-4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="index.css">

    <link rel="icon" href="favicon-vflz7uhzw.ico" sizes="32x32">
</head>
</html>