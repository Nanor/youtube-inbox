<!doctype html>
<html>
<head>
    <title>YouTube Inbox</title>
    <link rel="icon" href="favicon-vflz7uhzw.ico" sizes="32x32">
</head>
<body>
<div id="container"></div>

<script id="template" type="text/html">
    <div class="top-bar">
        <label class="btn btn-default settings-toggle" title="Settings">
            <i class="fa fa-gear"></i>
            <input class="hidden" type="checkbox" checked="{{showSettings}}">
        </label>
        <button class="btn btn-default" title="Refresh" on-tap="refresh">
            <i class="fa fa-refresh {{#if loading}}fa-spin{{/if}}"></i>
        </button>

        {{#each videoLists:list}}
        <label class="tab" id="{{name}}">
            <input type="radio" name="{{selectedList}}" value="{{list}}" class="hidden">
            <div class="text {{#if selectedList === list}}selected{{/if}}">{{capitalise(name)}}
                ({{listLength(this)}})
            </div>
        </label>
        {{/each}}

        {{#if selectedList === 0}}
        <button class="btn btn-default mark-all pull-right" title="Mark all as watched" on-tap="markAll:{{true}}">
            <i class="fa fa-check fa-fw"></i></button>
        {{elseif selectedList === 1}}
        <button class="btn btn-default mark-all pull-right" title="Mark all as unwatched" on-tap="markAll:{{false}}">
            <i class="fa fa-remove fa-fw"></i>
        </button>
        {{/if}}
    </div>
    <div class="videos">
        {{#each videoLists:list}}
        <div class="{{name}}-videos video-list {{#if selectedList !== list}}hidden{{/if}}">
            {{#each (reversed ? videos.slice().reverse() : videos)}}
            {{#if filter(this)}}
            <Video/>
            {{/if}}
            {{/each}}
        </div>
        {{/each}}
        <div class="no-videos">
            End of videos.
        </div>
    </div>

    <div class="settings {{#if !showSettings}}hidden{{/if}}">
        {{#if !apiLoaded}}
        <button class="btn btn-default" on-tap="login">Log in</button>
        {{/if}}
        <div>Update interval:<input class="form-control input-sm" type="number" value="{{update}}" maxlength="3"/>minutes.
            <em>(0 for never)</em></div>
        <div>Discard watched videos older than<input class="form-control input-sm" type="number" value=
                "{{history}}"/>day{{#if history !== 1}}s{{/if}} old.
        </div>
        <em>(Unwatched videos will be kept forever)</em>
        <div class="checkbox">
            <label><input type="checkbox" checked="{{autoplay}}">Auto-play videos?</label>
        </div>
        <div class="checkbox">
            <label><input type="checkbox" checked="{{expand}}">Expand playing videos?</label>
        </div>
        <div class="checkbox">
            <label><input type="checkbox" checked="{{watchLater}}">Use watch later integration?</label>
        </div>

        <div class="filter-panel">
            <h4>Filters:</h4>
            {{#if filter}}
            <div class="header">
                <span class="author">Channel Name:</span>
                <span class="type"></span>
                <span class="regex">Filter:</span>
            </div>
            {{/if}}
            <div class="rows">
                {{#each filter:index}}
                <div class="row">
                    <input class="author form-control input-sm" type="text" value="{{channel}}">
                    <select class="type form-control input-sm" value="{{type}}">
                        <option value="blacklist">Blacklist</option>
                        <option value="whitelist">Whitelist</option>
                    </select>
                    <input class="regex form-control input-sm" type="text" value="{{regexes}}">
                    <div on-tap="filterRemove:{{index}}" title="Remove this row">
                        <i class="fa fa-remove"></i>
                    </div>
                </div>
                {{/each}}
            </div>
            <button class="btn btn-default btn-sm" on-tap="filterAdd" title="Add new filter">Add</button>
        </div>

        <div class="additional-channels-panel">
            <h4>Additional YouTube Channels:</h4>
            {{#if additionalChannels}}
            <div class="header">
                <span class="name">Name:</span>
            </div>
            {{/if}}
            <div class="rows">
                {{#each additionalChannels:index}}
                <div class="row">
                    <a class="name" href="https://www.youtube.com/channel/{{id}}" target="_blank">{{name}}</a>
                    <div on-tap="channelRemove:{{index}}" title="Remove this channel">
                        <i class="fa fa-remove"></i>
                    </div>
                </div>
                {{/each}}
            </div>
            <form class="add-channel input-group input-group-sm" on-submit="channelAdd">
                <input type="text" class="name-input form-control" placeholder="Channel URL" value="{{newChannel}}">
                <span class="input-group-btn">
                    <input type="submit" class="btn btn-default" value="Add Channel">
                </span>
            </form>
        </div>
    </div>
</script>

<script id="video-component" type="text/html">
    <div class="video-container {{#if expanded}}expanded{{/if}}" id="video-container">
        <div class="video" id="video" on-tap="play">
            <div class="thumbnail" style="background-image: url({{thumbnail}})">
                <p class="title">{{title}}</p>
                <i class="play-icon fa fa-play fa-3x"></i>
                <p class="duration">{{formatDuration(duration)}}</p>
            </div>
        </div>
        <div class="video-info">
            <div class="author">
                <a href="http://www.youtube.com/channel/{{authorId}}" target="_blank">{{author}}</a>
            </div>
            <div class="upload-date">uploaded {{formatDate(publishedDate)}}</div>

            <div class="description {{#if truncated}}truncated{{/if}}">
                {{#each paragraphs(description)}}
                <p>{{{this}}}</p>
                {{/each}}
            </div>

            <label>
                <input type="checkbox" checked="{{truncated}}" class="hidden">
                <span>{{#if truncated}}Read more{{else}}Read less{{/if}}</span>
            </label>
        </div>
        <div class="side-buttons">
            {{#if !blocked(this)}}
            {{#if !watched}}
            <button class="btn btn-default" title="Mark as watched" on-tap="mark" id="mark">
                <i class="fa fa-check fa-3x fa-fw"></i></button>
            {{else}}
            <button class="btn btn-default" title="Mark as unwatched" on-tap="mark">
                <i class="fa fa-remove fa-3x fa-fw"></i></button>
            {{/if}}
            {{/if}}
            <a class="youtube-watch btn btn-default" title="Watch on YouTube"
               href="https://www.youtube.com/watch?v={{id}}" target="_blank">
                <i class="fa fa-youtube fa-3x fa-fw"></i>
            </a>
            <label>
                <input type="checkbox" checked="{{expanded}}" id="expand" class="hidden">
                {{#if expanded}}
                <div class="btn btn-default" title="Compress Video">
                    <i class="fa fa-compress fa-3x fa-fw"></i>
                </div>
                {{else}}
                <div class="btn btn-default" title="Expand Video">
                    <i class="fa fa-expand fa-3x fa-fw"></i></div>
                {{/if}}
            </label>
        </div>
    </div>
</script>

<script src="bundle.js"></script>
</body>
</html>